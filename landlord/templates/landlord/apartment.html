{% extends 'landlord/base.html' %}

{% block title %} Apartment {% endblock %}

{% block content %}

{% load static %}

<nav class="navbar navbar-expand-md navbar-dark fixed-top" style="background: #f11f25;">
    <a class="navbar-brand font-weight-bold" href="{% url 'landlord:home' %}" style="color: white;">Landlord</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault"
        aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link font-weight-bold" style="color: white;" href="{% url 'landlord:apartment' %}">Apartment</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" style="color: #d1d1d1;" href="{% url 'landlord:employee' %}">Employee<span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="color: #d1d1d1;" href="{% url 'landlord:tenant' %}">Tenant</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="color: #d1d1d1;" href="{% url 'landlord:parking' %}">Parking</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="color: #d1d1d1;" href="{% url 'landlord:room' %}">Room</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="color: #d1d1d1;" href="{% url 'landlord:lease_contract' %}">Lease Contract</a>
            </li>
        </ul>
    </div>
    <a href="{% url 'login' %}">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="white" class="bi bi-box-arrow-in-right" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0z"/>
        <path fill-rule="evenodd" d="M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"/>
    </svg>
    </a>
</nav>

<main role="main">
    <br>
    <br>
    <br>
    <div class="container-fluid">
        <div class="row">
            <!-- Data Section (Left) -->
            <div class="col-md-7" style="margin-left: 5%;">
                <div class="data-section" style="margin-top: 40px; background: #fffee8; padding-top: 40px; padding-left: 40px; padding-bottom: 20px; border: 1px solid gray;">
                    <h2 style="font-weight: 600; font-size: 40px;">{{ apartment.name }}</h2>
                    <h2 style="font-size: 25px;">Location: {{ location.address }}</h2>
                    <hr class="hr" />

                    <div style="display: flex; align-items: center; margin: 20px; gap: 20px; margin-top: 50px; margin-bottom: 30px; padding-left: 20px;" >
                        <svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 450 612">
                            <path style="fill: #6dc6f1;" d="M192 0c-41.8 0-77.4 26.7-90.5 64L64 64C28.7 64 0 92.7 0 128L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64l-37.5 0C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM128 256a64 64 0 1 1 128 0 64 64 0 1 1 -128 0zM80 432c0-44.2 35.8-80 80-80l64 0c44.2 0 80 35.8 80 80c0 8.8-7.2 16-16 16L96 448c-8.8 0-16-7.2-16-16z"/>
                        </svg>
                        <div style="flex: 1; border-left: 2px solid #ccc; padding-left: 50px; margin-left: 20px;">
                            <h2 style="padding-bottom: 10px;">Employee</h2>
                            <p style="font-size: 20px; margin: 5px 30px;">Total Employee: {{ total_employee }}</p>
                            <p style="font-size: 20px; margin: 5px 30px;">Total Salary (/month): {{ total_salary }}</p>
                        </div>
                    </div>

                    <div style="display: flex; align-items: center; margin: 20px; gap: 20px; margin-bottom: 30px; padding-left: 20px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="90" height="90" viewBox="0 0 550 612">
                            <path style="fill: #6dc6f1;" d="M48 0C21.5 0 0 21.5 0 48L0 464c0 26.5 21.5 48 48 48l96 0 0-80c0-26.5 21.5-48 48-48s48 21.5 48 48l0 80 96 0c26.5 0 48-21.5 48-48l0-416c0-26.5-21.5-48-48-48L48 0zM64 240c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zm112-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zM80 96l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zM272 96l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16z"/>
                        </svg>

                        <div style="flex: 1; border-left: 2px solid #ccc; padding-left: 50px; margin-left: 20px;">
                            <h2 style="padding-bottom: 10px;">Room</h2>
                            <p style="font-size: 20px; margin: 5px 30px;">Total Room: {{ total_room }}</p>
                            <p style="font-size: 20px; margin: 5px 30px;">Occupied Room: {{ occupied_count }}</p>
                            <p style="font-size: 20px; margin: 5px 30px;">Available Room: {{ available_count }}</p>
                        </div>
                    </div>

                    <div style="display: flex; align-items: center; margin: 20px; gap: 20px; margin-bottom: 30px; padding-left: 20px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="80" height="90" fill="currentColor" class="bi bi-file-earmark-post" viewBox="0 0 16 16">
                          <path style="fill: #6dc6f1;" d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"/>
                          <path style="fill: #6dc6f1;" d="M4 6.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5zm0-3a.5.5 0 0 1 .5-.5H7a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5"/>
                        </svg>

                        <div style="flex: 1; border-left: 2px solid #ccc; padding-left: 50px; margin-left: 30px;">
                            <h2 style="padding-bottom: 10px;"> Lease Contract</h2>
                            <p style="font-size: 20px; margin: 5px 30px;">Total Contract: {{ total_contract }}</p>
                            <p style="font-size: 20px; margin: 5px 30px;">Active Contract: {{ active_count }}</p>
                            <p style="font-size: 20px; margin: 5px 30px;">Expired Contract: {{ expired_count }}</p>
                            <p style="font-size: 20px; margin: 5px 30px;">Total Income: {{ total_income }}</p>
                            <p style="font-size: 20px; margin: 5px 30px;">Average Income(/month): {{ avg_income }}</p>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Graph Section (Right) -->
            <div class="col-md-3" style="margin-left: 20px; width: 30%;">
                <div class="container" style="margin-top: 40px; background: #e1f5ff; padding: 20px; border: 1px solid gray;">
                    <h2 class="text-center mb-4" style="font-size: 20px;">Outcome VS Income<br> (per month)</h2>
                    <div class="row">
                        <div class="col-md-12">
                            <canvas id="salaryIncomeChart" style="width: 400px; height: 300px;"></canvas>
                        </div>
                    </div>
                </div>

                <script>
                    // Chart.js Setup
                    const ctx = document.getElementById('salaryIncomeChart').getContext('2d');

                    const data = {
                        labels: ['Comparison'],
                        datasets: [
                            {
                                label: 'Outcome',
                                data: [{{ outcome }}],
                                backgroundColor: '#ff7b7f',
                            },
                            {
                                label: 'Income',
                                data: [{{ income }}],
                                backgroundColor: '#a1ebb5',
                            }
                        ]
                    };

                    const options = {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(tooltipItem) {
                                        return tooltipItem.dataset.label + tooltipItem.raw;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Amount',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Comparison',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            }
                        }
                    };

                    new Chart(ctx, {
                        type: 'bar',
                        data: data,
                        options: options
                    });
                </script>

               <div class="container" style="margin-top: 14px; background: #e1f5ff; padding: 20px; border: 1px solid gray;">
                    <h2 class="text-center mb-4" style="font-size: 20px;">Room Status</h2>
                    <div class="row">
                        <div class="col-md-12">
                            <canvas id="roomStatusChart" style="width: 400px; height: 300px;"></canvas>
                        </div>
                    </div>
                </div>

                <script>
                    const occupiedCount = {{ occupied_count|default:0 }};
                    const availableCount = {{ available_count|default:0 }};

                    const ctx2 = document.getElementById('roomStatusChart').getContext('2d');
                    const data2 = {
                        labels: ['Occupied Rooms', 'Available Rooms'],
                        datasets: [{
                            data: [occupiedCount, availableCount],
                            backgroundColor: ['#ff7b7f', '#a1ebb5'],
                        }]
                    };

                    const options2 = {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(tooltipItem) {
                                        return tooltipItem.label + ': ' + tooltipItem.raw;
                                    }
                                }
                            }
                        }
                    };

                    new Chart(ctx2, {
                        type: 'pie', // Type of chart
                        data: data2,
                        options: options2
                    });
                </script>
            </div>
        </div>
    </div>
</main>
{% endblock %}
